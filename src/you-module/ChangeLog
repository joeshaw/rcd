2004-07-12  Tambet Ingo  <tambet@ximian.com>

	* wrapper.cc (read_installed_patches): Test if INSTALLED_YOU_PATH
	exists before trying to open it. Fixes #61375.

2004-06-17  Tambet Ingo  <tambet@ximian.com>

	* you-util.[ch]: Add a constant temporary working directory for
	patches to header file so wrapper.cc can use it.

	* wrapper.cc (rc_you_patch_from_yast_patch): Remove some #ifdef'ed
	out code. Don't even try to determine whether the patch is installed,
	it never works correctly. Yay for yast!
	(rc_you_wrapper_install_patches): Make sure patch name AND version
	match before installing a patch. Use rc_debug() instead of g_print().
	(read_installed_patches): Implement. Can't trust PMPatchManager to
	read installed patches so implement out own version which actually
	works.
	(rc_you_wrapper_get_installed_patches): Don't trust yast, use
	read_installed_patches().

2004-06-16  Tambet Ingo  <tambet@ximian.com>

	* rc-you-query.c: Add new query keywords "name-installed", and
	"patch-installed".
	(name_installed_match): Implement.
	(patch_installed_match): Implement.

2004-06-15  Tambet Ingo  <tambet@ximian.com>

	* you-util.c (get_you_basedir): Create directory if it does not
	exist.
	(get_you_patchdir): Ditto.
	(get_you_scriptdir): Ditto.

	* rc-you-transaction.c (get_files_to_download): Use different url
	prefix for package downloads.

2004-06-14  Tambet Ingo  <tambet@ximian.com>

	* you.c (you_ping): Delete. (Hey Joe!).
	(find_latest_version): Implement.
	(find_latest_installed_version): Implement.
	(you_find_latest_version): Implement.
	(rcd_module_load): Don't export "rcd.you.ping" RPC call. Register
	"rcd.you.find_latest_version".

	* you-util.c (installed_check_cb): Implement.
	(rc_you_patch_to_xmlrpc): Guess patch channel for installed patches.
	Set "name_installed" for patches from channels.

	* rc-world-you.c (rc_world_multi_get_patch): Use foreach_by_name
	so the callback function doesn't have to check name and channel.
	(foreach_patch_by_name_cb): Implement.
	(rc_world_multi_foreach_patch_by_name): Implement.
	(guess_cb): Implement.
	(rc_world_multi_guess_patch_channel): Implement.
	(fetch_patches_cb): Don't filter anything here.
	(rc_world_add_patches): Touch package sequence number to make sure
	client will pick up updated patch list.

2004-06-11  Tambet Ingo  <tambet@ximian.com>

	* rc-you-query.[ch]: New files. Implement patch querying,
	similary to package querying.

	* you.c (you_ping): Implement. The gui uses it to figure out
	whether to add patch support.
	(add_patch_cb): Implement.
	(you_search): Rewrite, using RCDQuery.
	(you_list): Remove, you_search does that too.
	(you_transaction): Return pending step too.
	(you_license): Implement.
	(you_info): Implement.
	(rcd_module_load): Rename rcd.you.install to rcd.you.transact.

	* you-util.c (rc_you_patch_to_xmlrpc): Don't send license,
	summary and description fields. Usually noone cares about
	those, and if someone cares, there's new methods
	rcd.you.patch_info and rcd.you.licenses for that.

	* wrapper.cc (rc_you_wrapper_get_installed_patches): Assign
	system channel to installed patches.

	* rc-you-transaction.c (rc_you_transaction_get_step_pending):
	Implement.
	(rc_you_transaction_finalize): Free pending step as well.
	(rc_you_transaction_transaction): Use transaction pending step,
	so in future it could be hooked up to get transaction updates.

	* rc-you-patch.c (rc_you_patch_slist_lookup_licenses): Implement.

	* rc-world-you.c (rc_channel_get_patchinfo_file): Remove hardcoded
	distro target.
	(rc_world_add_patches): Pass system channel to wrapper.

	* Makefile.am (rcd_moduledir): Build rc-you-query.[ch]

2004-06-10  Tambet Ingo  <tambet@ximian.com>

	* rc-you-transaction.c (rc_you_transaction_transaction):
	There are no "dry run" patch transactions, I meant "download only".

	* Makefile.am: Install header files for other modules.

	* Initial cvs import. 

